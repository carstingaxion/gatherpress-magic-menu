(()=>{"use strict";var e,n={555(){const e=window.wp.blocks,n=window.wp.hooks,o=window.wp.blockEditor,t=window.wp.element,s=window.wp.data,a=window.wp.i18n,r=window.wp.coreData,l=window.wp.components,i=window.ReactJSXRuntime;function c({gatherpressTaxonomy:e,showEventCount:n,showTermEventCount:t,taxonomyOptions:s,onChangeTaxonomy:r,onChangeShowEventCount:c,onChangeShowTermEventCount:u}){return(0,i.jsx)(o.InspectorControls,{children:(0,i.jsxs)(l.PanelBody,{title:(0,a.__)("Magic Settings"),initialOpen:!0,children:[(0,i.jsx)(l.SelectControl,{label:(0,a.__)("Select Taxonomy for Submenu","gatherpress-magic-menu"),value:e,options:s,onChange:r,help:(0,a.__)('Select a taxonomy to show its terms, of upcoming events only, as an auto-generated submenu. Or leave as "None" to not create a submenu.',"gatherpress-magic-menu")}),(0,i.jsx)(l.ToggleControl,{label:(0,a.__)("Show Event Count","gatherpress-magic-menu"),checked:n,onChange:c,help:(0,a.__)("Display the number of upcoming events next to the main archive label.","gatherpress-magic-menu")}),e&&(0,i.jsx)(l.ToggleControl,{label:(0,a.__)("Show Term Event Count","gatherpress-magic-menu"),checked:t,onChange:u,help:(0,a.__)("Display the number of upcoming events next to each term link.","gatherpress-magic-menu")})]})})}class u{static formatWithCount(e,n){const o=(0,a.sprintf)('<span class="gatherpress-magic-menu__count %s">n</span>',n||"");return(0,a.sprintf)(/* translators: 1: label text, 2: event count HTML */ /* translators: 1: label text, 2: event count HTML */
(0,a.__)("%1$s %2$s","gatherpress-magic-menu"),e,o)}}function h({showTermEventCount:e,overlayClasses:n,overlayStyles:o,className:t}){const s=[(0,a.__)("Example Term 1","gatherpress-magic-menu"),(0,a.__)("Sample Term 2","gatherpress-magic-menu")];return(0,i.jsx)("ul",{className:"wp-block-navigation__submenu-container",children:s.map((s,a)=>{let r;return r=e?u.formatWithCount(s,t):s,(0,i.jsx)("li",{className:"wp-block-navigation-item wp-block-navigation-link",children:(0,i.jsx)("a",{className:n,style:o,href:"#",children:(0,i.jsx)("span",{className:"wp-block-navigation-item__label",dangerouslySetInnerHTML:{__html:r}})})},a)})})}function m({effectiveLabel:e,fallbackLabel:n,showEventCount:t,hasSubmenu:s,showSubmenuIcon:r,linkClasses:l,linkStyles:c,onChangeLabel:u,className:h}){return(0,i.jsxs)("a",{className:l,style:c,href:"#gatherpress-events-archive","aria-label":(0,a.__)("Link to GatherPress Events Archive","gatherpress-magic-menu"),children:[(0,i.jsx)(o.RichText,{identifier:"label",className:"wp-block-navigation-item__label",value:e,onChange:u,placeholder:n,withoutInteractiveFormatting:!0,allowedFormats:["core/bold","core/italic","core/image","core/strikethrough"],"aria-label":(0,a.__)("Navigation link text","gatherpress-magic-menu")}),t&&(0,i.jsx)("span",{className:(0,a.sprintf)("gatherpress-magic-menu__count %s",h||""),dangerouslySetInnerHTML:{__html:"n"}}),s&&r&&(0,i.jsx)("span",{className:"wp-block-navigation__submenu-icon","aria-hidden":"true",children:(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",role:"img","aria-hidden":"true",focusable:"false",children:(0,i.jsx)("path",{d:"M1.50002 4L6.00002 8L10.5 4",fill:"none",stroke:"currentColor",strokeWidth:"1.5"})})})]})}if("undefined"==typeof window)throw new Error("This file should only be loaded in a browser environment");const g=JSON.parse('{"UU":"gatherpress/magic-menu"}');(0,n.addFilter)("blocks.registerBlockType","gatherpress-magic-menu/allow-in-core-navigation",(e,n)=>{var o;return"core/navigation"!==n?e:{...e,allowedBlocks:[...null!==(o=e.allowedBlocks)&&void 0!==o?o:[],"gatherpress-magic-menu"]}}),(0,e.registerBlockType)(g.UU,{edit:function({attributes:e,context:n,setAttributes:l,clientId:u,className:g}){const{label:p,gatherpressTaxonomy:v,showEventCount:b,showTermEventCount:w}=e,{linkStyles:d,overlayStyles:k,linkClasses:C,overlayClasses:_,showSubmenuIcon:f}=function(e){const{textColor:n,customTextColor:o,backgroundColor:s,customBackgroundColor:r,overlayTextColor:l,customOverlayTextColor:i,overlayBackgroundColor:c,customOverlayBackgroundColor:u,showSubmenuIcon:h}=e;return{linkStyles:(0,t.useMemo)(()=>{const e={};if(o&&(e.color=o),r&&(e.backgroundColor=r),Object.keys(e).length>0)return e},[o,r]),overlayStyles:(0,t.useMemo)(()=>{const e={};if(i&&(e.color=i),u&&(e.backgroundColor=u),Object.keys(e).length>0)return e},[i,u]),linkClasses:(0,t.useMemo)(()=>{const e=["wp-block-navigation-item__content"];return n&&(e.push((0,a.sprintf)("has-%s-color",n)),e.push("has-text-color")),s&&(e.push((0,a.sprintf)("has-%s-background-color",s)),e.push("has-background")),e.join(" ")},[n,s]),overlayClasses:(0,t.useMemo)(()=>{const e=["wp-block-navigation-item__content"];return l&&(e.push((0,a.sprintf)("has-%s-color",l)),e.push("has-text-color")),c&&(e.push((0,a.sprintf)("has-%s-background-color",c)),e.push("has-background")),e.join(" ")},[l,c]),showSubmenuIcon:h}}(n),y=function(){const e=(0,s.useSelect)(e=>{const{getTaxonomies:n}=e(r.store);return(n({per_page:-1})||[]).filter(e=>e.types&&e.types.includes("gatherpress_event"))},[]);return(0,t.useMemo)(()=>{const n=[{label:(0,a.__)("None","gatherpress-magic-menu"),value:""}];if(e){const o=e.map(e=>{let n=e.slug;return e.name&&(n=e.name),{label:n,value:e.slug}});n.push(...o)}return n},[e])}(),x=function(){const e=(0,s.useSelect)(e=>{const{getPostType:n}=e(r.store);return n("gatherpress_event")},[]);return(0,t.useMemo)(()=>e&&e.labels&&e.labels.name?e.labels.name:(0,a.__)("Events","gatherpress-magic-menu"),[e])}(),S=p||x,T=Boolean(v),j=(0,o.useBlockProps)({className:T?"wp-block-navigation-item wp-block-navigation-submenu has-child open-on-hover-click":"wp-block-navigation-item wp-block-navigation-link"}),{updateBlockAttributes:E}=(0,s.useDispatch)("core/block-editor"),O=(0,t.useRef)(S);return(0,t.useEffect)(()=>{S&&u&&O.current!==S&&(O.current=S,E(u,{metadata:{name:S}}))},[S,u,E]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(c,{gatherpressTaxonomy:v,showEventCount:b,showTermEventCount:w,taxonomyOptions:y,onChangeTaxonomy:e=>{l({gatherpressTaxonomy:e})},onChangeShowEventCount:e=>{l({showEventCount:e})},onChangeShowTermEventCount:e=>{l({showTermEventCount:e})}}),(0,i.jsxs)("li",{...j,children:[(0,i.jsx)(m,{effectiveLabel:S,fallbackLabel:x,showEventCount:b,hasSubmenu:T,showSubmenuIcon:f,linkClasses:C,linkStyles:d,onChangeLabel:e=>{l({label:e})},className:g}),T&&(0,i.jsx)(h,{showTermEventCount:w,overlayClasses:_,overlayStyles:k,className:g})]})]})}})}},o={};function t(e){var s=o[e];if(void 0!==s)return s.exports;var a=o[e]={exports:{}};return n[e](a,a.exports,t),a.exports}t.m=n,e=[],t.O=(n,o,s,a)=>{if(!o){var r=1/0;for(u=0;u<e.length;u++){for(var[o,s,a]=e[u],l=!0,i=0;i<o.length;i++)(!1&a||r>=a)&&Object.keys(t.O).every(e=>t.O[e](o[i]))?o.splice(i--,1):(l=!1,a<r&&(r=a));if(l){e.splice(u--,1);var c=s();void 0!==c&&(n=c)}}return n}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[o,s,a]},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),(()=>{var e={57:0,350:0};t.O.j=n=>0===e[n];var n=(n,o)=>{var s,a,[r,l,i]=o,c=0;if(r.some(n=>0!==e[n])){for(s in l)t.o(l,s)&&(t.m[s]=l[s]);if(i)var u=i(t)}for(n&&n(o);c<r.length;c++)a=r[c],t.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return t.O(u)},o=globalThis.webpackChunkblock_gatherpress_magic_menu=globalThis.webpackChunkblock_gatherpress_magic_menu||[];o.forEach(n.bind(null,0)),o.push=n.bind(null,o.push.bind(o))})();var s=t.O(void 0,[350],()=>t(555));s=t.O(s)})();